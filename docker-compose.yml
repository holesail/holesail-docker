services:
  holesail:
    build: .
    container_name: holesail
    restart: unless-stopped
    ports:
      - "8090:8090"
    volumes:
      - holesail_data:/usr/src/app/data
      - ./config:/usr/src/app/config:ro
    environment:
      - NODE_ENV=production
      - HOLESAIL_LOGGING_LEVEL=info
      - HOLESAIL_SERVICE_PORT=8090
      # Optional environment variables:
      # - HOLESAIL_BIND_HOST=localhost
      # - HOLESAIL_SERVER_KEY=your_custom_key
      # - HOLESAIL_KEY_SEED=your_seed
      # - HOLESAIL_ENABLE_PUBLIC=true
      # - HOLESAIL_DEBUG=true
    networks:
      - holesail-network
    extra_hosts:
      - "host.docker.internal:host-gateway"
  holesail-client:
    build: .
    container_name: holesail-client
    restart: unless-stopped
    ports:
      - "9090:9090"
    volumes:
      - holesail_client_data:/usr/src/app/data
    environment:
      - NODE_ENV=production
      - HOLESAIL_LOGGING_LEVEL=info
      - HOLESAIL_CLIENT_KEY=${HOLESAIL_SERVER_KEY}
      - HOLESAIL_CLIENT_PORT=9090
      # Optional:
      # - HOLESAIL_DEBUG=true
    networks:
      - holesail-network
    profiles:
      - client
    depends_on:
      - holesail
networks:
  holesail-network:
    driver: bridge
volumes:
  holesail_data:
  holesail_client_data:
